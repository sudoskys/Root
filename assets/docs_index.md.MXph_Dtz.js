import{_ as s,o as a,c as e,U as t}from"./chunks/framework.zvL6SVfk.js";const b=JSON.parse('{"title":"前言","description":"","frontmatter":{},"headers":[],"relativePath":"docs/index.md","filePath":"docs/index.md","lastUpdated":1706549544000}'),o={name:"docs/index.md"},i=t(`<h1 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h1><p>本教程包含 <code>Android</code> 设备的 <code>Root</code> 与 <code>刷机</code> 教程，以及 <code>Magisk</code> 模块的使用方法和注意事项，供刷写机器时进行速查或者作为入门教程。</p><p>仓库地址是 <a href="https://github.com/sudoskys/Root/" target="_blank" rel="noreferrer">sudoskys/Root</a></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>刷写机器有风险，刷机前请做好备份。 因为机型众多，本教程难免疏漏，请多多询问同机型用户。如果对自己的能力感到怀疑，请委托专人刷写机器。 作者不会对刷机过程中的任何损失负责。</p></div><h1 id="快速开始" tabindex="-1">快速开始 <a class="header-anchor" href="#快速开始" aria-label="Permalink to &quot;快速开始&quot;">​</a></h1><p>此页面为快速开始，介绍整个流程。</p><p>我为 <code>VAB分区</code> <code>SELinux</code> 撰写的其他科普专题，请点击左侧导航栏。</p><h2 id="什么是-root" tabindex="-1">什么是 Root <a class="header-anchor" href="#什么是-root" aria-label="Permalink to &quot;什么是 Root&quot;">​</a></h2><p>Root，即超级用户，是 Android 系统中的最高权限，拥有 Root 权限的用户可以对系统进行任意修改，包括删除系统自带的应用、修改系统文件、更换系统字体、更换系统主题、更换系统开机动画等等。[^1]</p><p>但是厂商并不希望用户获取 Root 权限，因为这会破坏系统安全，并且可能会被不法分子利用。</p><p>目前，最流行的 Root 框架是 <code>Magisk</code>，我们使用 <code>adb</code> 和 <code>fastboot</code> 工具链接手机和烧录 <code>Magisk</code> 修补后的分区文件，来获取 Root 权限。</p><p>下文将会主要介绍这种方法。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>因为 Android 阵营厂商众多，的确很难保证他们步伐齐一，所以本教程只会介绍通用的刷机方法和几个专题。 如果你的机型不在本教程中，可以尝试在 <a href="https://forum.xda-developers.com/" target="_blank" rel="noreferrer">xda-developers</a> 或 知乎，酷安 上搜索你的机型。</p></div><h2 id="还没有买手机" tabindex="-1">还没有买手机？ <a class="header-anchor" href="#还没有买手机" aria-label="Permalink to &quot;还没有买手机？&quot;">​</a></h2><p>如果你还没有买手机，可以参考 <a href="https://github.com/KHwang9883/MobileModels/blob/master/misc/bootloader-kernel-source.md" target="_blank" rel="noreferrer">Bootloader 解锁各厂商支持列表</a>。</p><h2 id="流程-线刷" tabindex="-1">流程(线刷) <a class="header-anchor" href="#流程-线刷" aria-label="Permalink to &quot;流程(线刷)&quot;">​</a></h2><p>引用 少数派教程<a href="https://sspai.com/post/67932" target="_blank" rel="noreferrer">^3</a> 的大致流程图如下：</p><p><img src="https://user-images.githubusercontent.com/75739606/207025077-5d0231c7-08b1-4856-98c9-15c3efc1410a.png" alt="引用自少数派"></p><p>要查询你的机型是否可以刷机，需要做以下几步调查：</p><ul><li>是否允许解锁 Bootloader</li><li>是否有可用的同系统版本的 Rom 包</li><li>刷写分区是 <code>boot</code> 还是 <code>init_boot</code></li><li>如果没有，是否有其他玩家成功刷入</li><li>如果没有，论坛询问其他玩家</li></ul><h2 id="备份数据" tabindex="-1">备份数据 <a class="header-anchor" href="#备份数据" aria-label="Permalink to &quot;备份数据&quot;">​</a></h2><p>利用手机自带的备份功能，备份好你的数据，比如短信、通讯录、照片、视频、聊天记录、音乐等等。</p><p>接下来的操作会清除你的手机数据，所以请务必备份你的数据到<strong>其他存储设备</strong>。</p><h2 id="准备刷写环境" tabindex="-1">准备刷写环境 <a class="header-anchor" href="#准备刷写环境" aria-label="Permalink to &quot;准备刷写环境&quot;">​</a></h2><h3 id="寻找一键工具箱" tabindex="-1">寻找一键工具箱 <a class="header-anchor" href="#寻找一键工具箱" aria-label="Permalink to &quot;寻找一键工具箱&quot;">​</a></h3><p>如果你的机型有一键工具箱，那么你可以直接使用它来刷机，类似 大侠阿木的 <a href="https://optool.daxiaamu.com" target="_blank" rel="noreferrer">一加全能工具箱</a>。</p><p>如果你觉得仍然有必要学习刷机的话，那么你可以继续阅读本教程。</p><h3 id="准备-magisk" tabindex="-1">准备 <strong>Magisk</strong> <a class="header-anchor" href="#准备-magisk" aria-label="Permalink to &quot;准备 **Magisk**&quot;">​</a></h3><p>为了准备修补系统分区获取 Root 权限，请从 <a href="https://github.com/topjohnwu/Magisk/releases" target="_blank" rel="noreferrer">Github</a> 下载最新版本 Magisk。</p><p><code>Ramdisk</code> 是系统中的一个小分区，<code>Ramdisk</code> 告诉系统需要加载哪些东西。而 Magisk 的目的就是修改 <code>Ramdsik</code>，把自己加进开机需要加载的系统组件中。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>安装 <code>Magisk Manager</code> 后如果主页面 <code>Ramdisk</code> 为 <code>是</code>，那么你才可以用面具刷写机器，反之只能放弃线刷。 当 <code>Ramdisk</code> 的值为「否」时，表示需要修改的 Ramdisk 被放在了 <code>recovery.img</code> 中，我们需要提取并修改 <code>recovery.img</code>，具体详情需要查阅专题。</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>少数小米设备存在检测设备信息错误的问题，Ramdisk 虽然显示为 <code>否</code>，但实际上需要修改 boot.img，具体请询问相同机型的刷机爱好者。</p></div><h3 id="安装手机驱动" tabindex="-1">安装手机驱动 <a class="header-anchor" href="#安装手机驱动" aria-label="Permalink to &quot;安装手机驱动&quot;">​</a></h3><p>你必须安装驱动才能调试你的设备。不同的安卓系统需要不同的驱动，它们一般由手机厂商提供。</p><p>如果你持有 <code>Google</code> 手机，你可以安装 <a href="https://developer.android.com/studio/run/win-usb" target="_blank" rel="noreferrer">Google USB 驱动</a>。</p><p>其他厂商的驱动如下表所示：</p><table><thead><tr><th>OEM</th><th>Driver URL</th></tr></thead><tbody><tr><td>Acer</td><td><a href="https://www.acer.com/worldwide/support/" target="_blank" rel="noreferrer">https://www.acer.com/worldwide/support/</a></td></tr><tr><td>Alcatel Mobile</td><td><a href="https://www.alcatelmobile.com/support/" target="_blank" rel="noreferrer">https://www.alcatelmobile.com/support/</a></td></tr><tr><td>Asus</td><td><a href="https://www.asus.com/support/Download-Center/" target="_blank" rel="noreferrer">https://www.asus.com/support/Download-Center/</a></td></tr><tr><td>Blackberry</td><td><a href="https://swdownloads.blackberry.com/Downloads/entry.do?code=4EE0932F46276313B51570F46266A608" target="_blank" rel="noreferrer">https://swdownloads.blackberry.com/Downloads/entry.do?code=4EE0932F46276313B51570F46266A608</a></td></tr><tr><td>Dell</td><td><a href="https://support.dell.com/support/downloads/index.aspx?c=us&amp;cs=19&amp;l=en&amp;s=dhs&amp;~ck=anavml" target="_blank" rel="noreferrer">https://support.dell.com/support/downloads/index.aspx?c=us&amp;cs=19&amp;l=en&amp;s=dhs&amp;~ck=anavml</a></td></tr><tr><td>FCNT</td><td><a href="https://www.fcnt.com/support/develop/#anc-03" target="_blank" rel="noreferrer">https://www.fcnt.com/support/develop/#anc-03</a></td></tr><tr><td>HTC</td><td><a href="https://www.htc.com/support" target="_blank" rel="noreferrer">https://www.htc.com/support</a></td></tr><tr><td>Huawei</td><td><a href="https://consumer.huawei.com/en/support/index.htm" target="_blank" rel="noreferrer">https://consumer.huawei.com/en/support/index.htm</a></td></tr><tr><td>Intel</td><td><a href="https://www.intel.com/software/android" target="_blank" rel="noreferrer">https://www.intel.com/software/android</a></td></tr><tr><td>Kyocera</td><td><a href="https://kyoceramobile.com/support/drivers/" target="_blank" rel="noreferrer">https://kyoceramobile.com/support/drivers/</a></td></tr><tr><td>Lenovo</td><td><a href="https://support.lenovo.com/us/en/GlobalProductSelector" target="_blank" rel="noreferrer">https://support.lenovo.com/us/en/GlobalProductSelector</a></td></tr><tr><td>LGE</td><td><a href="https://www.lg.com/us/support/software-firmware" target="_blank" rel="noreferrer">https://www.lg.com/us/support/software-firmware</a></td></tr><tr><td>Motorola</td><td><a href="https://motorola-global-portal.custhelp.com/app/answers/detail/a_id/88481" target="_blank" rel="noreferrer">https://motorola-global-portal.custhelp.com/app/answers/detail/a_id/88481/</a></td></tr><tr><td>MTK</td><td><a href="http://online.mediatek.com/Public%20Documents/MTK_Android_USB_Driver.zip" target="_blank" rel="noreferrer">http://online.mediatek.com/Public%20Documents/MTK_Android_USB_Driver.zip</a>(ZIP download)</td></tr><tr><td>Samsung</td><td><a href="https://developer.samsung.com/galaxy/others/android-usb-driver-for-windows" target="_blank" rel="noreferrer">https://developer.samsung.com/galaxy/others/android-usb-driver-for-windows</a></td></tr><tr><td>Sharp</td><td><a href="http://k-tai.sharp.co.jp/support/" target="_blank" rel="noreferrer">http://k-tai.sharp.co.jp/support/</a></td></tr><tr><td>Sony Mobile Communications</td><td><a href="https://developer.sonymobile.com/downloads/drivers/" target="_blank" rel="noreferrer">https://developer.sonymobile.com/downloads/drivers/</a></td></tr><tr><td>Toshiba</td><td><a href="https://support.toshiba.com/sscontent?docId=4001814" target="_blank" rel="noreferrer">https://support.toshiba.com/sscontent?docId=4001814</a></td></tr><tr><td>Xiaomi</td><td><a href="https://web.vip.miui.com/page/info/mio/mio/detail?postId=18464849&amp;app_version=dev.20051" target="_blank" rel="noreferrer">https://web.vip.miui.com/page/info/mio/mio/detail?postId=18464849&amp;app_version=dev.20051</a></td></tr><tr><td>ZTE</td><td><a href="http://support.zte.com.cn/support/news/NewsDetail.aspx?newsId=1000442" target="_blank" rel="noreferrer">http://support.zte.com.cn/support/news/NewsDetail.aspx?newsId=1000442</a></td></tr></tbody></table><blockquote><p>表中数据来自 <a href="https://developer.android.com/studio/run/oem-usb#Drivers" target="_blank" rel="noreferrer">Install OEM USB drivers</a></p></blockquote><h3 id="安装-adb-和-fastboot-工具" tabindex="-1">安装 <code>adb</code> 和 <code>fastboot</code> 工具 <a class="header-anchor" href="#安装-adb-和-fastboot-工具" aria-label="Permalink to &quot;安装 \`adb\` 和 \`fastboot\` 工具&quot;">​</a></h3><p><a href="https://developer.android.google.cn/tools/releases/platform-tools" target="_blank" rel="noreferrer">手动安装</a></p><ul><li><strong>Windows10 系统</strong></li></ul><p>按住 <code>shift</code> 键，点击 <code>右键</code>，选择 <code>在此处打开 PowerShell 窗口</code>。</p><p>输入以下命令：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Set-ExecutionPolicy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ExecutionPolicy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RemoteSigned</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CurrentUser</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Invoke-RestMethod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Uri</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://get.scoop.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Invoke-Expression</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scoop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aria2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scoop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main/adb</span></span></code></pre></div><p>等待安装完成。</p><ul><li><strong>Linux 系统</strong></li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Debian</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> android-tools-adb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> android-tools-fastboot</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CentOS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> android-tools</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> android-tools-fastboot</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Arch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> android-tools</span></span></code></pre></div><ul><li><strong>macOS 系统</strong></li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> android-platform-tools</span></span></code></pre></div><h4 id="测试-adb-链接" tabindex="-1">测试 <code>adb</code> 链接 <a class="header-anchor" href="#测试-adb-链接" aria-label="Permalink to &quot;测试 \`adb\` 链接&quot;">​</a></h4><p>在 <code>关于手机</code> 中找到 <code>版本号</code>，连续点击，进入开发者模式，打开 <code>USB调试</code>。</p><p>使用<strong>可靠</strong>的 USB 数据线连接手机和电脑。</p><p>在弹出窗口中选择 <code>允许文件传输</code> 和 <code>一律允许此设备进行 USB 调试</code>。</p><p>打开 <code>PowerShell</code> 或 <code>终端</code>，输入 <code>adb devices</code> 列出设备，如果出现以下结果，说明链接成功。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> devices</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> attached</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> device</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>如果你在之后的步骤中遇到了 <code>xxx offline</code> 的问题（例如在切换到同设备的其他系统）。 请按照下面的操作重启链接。</p><ul><li>拔掉 USB 数据线</li><li>在电脑终端输入 <code>adb kill-server</code> 关闭 <code>adb</code> 服务，然后输入 <code>adb start-server</code> 重启 <code>adb</code> 服务</li><li>在手机中关闭 <code>USB调试</code></li><li>撤销 <code>USB调试</code> 的授权</li><li>重新插入 USB 数据线</li><li>重新打开 <code>USB调试</code> 并授权</li></ul></div><h4 id="使用-adb-和-fastboot-工具的小技巧" tabindex="-1">使用 <code>adb</code> 和 <code>fastboot</code> 工具的小技巧 <a class="header-anchor" href="#使用-adb-和-fastboot-工具的小技巧" aria-label="Permalink to &quot;使用 \`adb\` 和 \`fastboot\` 工具的小技巧&quot;">​</a></h4><ul><li>ADB</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">adb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bootloader</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     #进入 Bootloader 模式-</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">adb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shell</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 #启动 ADB 终端--</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">adb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">loca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">remot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #从本地复制文件到设备---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">adb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">remot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">loca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #从设备复制文件到本地----</span></span></code></pre></div><ul><li>Fastboot</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fastboot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span></span></code></pre></div><h2 id="解锁-bootloader" tabindex="-1">解锁 Bootloader <a class="header-anchor" href="#解锁-bootloader" aria-label="Permalink to &quot;解锁 Bootloader&quot;">​</a></h2><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>解锁 Bootloader 会清除你的手机数据。 解锁 Bootloader 后，你可能会面临失去保修，损坏 <code>TTE</code> ，无法使用某些应用，无法升级系统等问题。</p></div><p><strong>请阅读 <a href="https://github.com/KHwang9883/MobileModels/blob/master/misc/bootloader-kernel-source.md" target="_blank" rel="noreferrer">Bootloader 解锁支持列表</a>。</strong></p><p>Bootloader 是 Android 系统开始运行前的一个小程序，它是运行的第一个程序。</p><p>Bootloader 由 OEM厂商（华为、小米和三星等）锁定，或由运营商限制，以防止用户安装其他系统。我们需要解锁 Bootloader 才能。</p><p>解锁 Bootloader 会清除手机内的所有数据，所以在解锁前请做好备份。</p><p>一些安卓厂商会开放解锁 Bootloader 的权限，比如一加，或者设置一些门槛，比如小米采用<a href="https://github.com/MlgmXyysd/Xiaomi-BootLoader-Questionnaire" target="_blank" rel="noreferrer">答题</a> 来测试用户水平。</p><p>有些安卓厂商会禁止解锁 Bootloader ，比如华为的部分机型。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>除了官方的解锁方式，还有一些第三方的解锁方式，比如 <a href="./">9008短接/线刷</a> 和 <a href="./">MTK漏洞</a>。 当然，还有万能的淘宝。</p></div><h3 id="解锁步骤" tabindex="-1">解锁步骤 <a class="header-anchor" href="#解锁步骤" aria-label="Permalink to &quot;解锁步骤&quot;">​</a></h3><p>使用可靠的 USB 数据线连接手机和电脑。</p><p>在 <code>关于手机</code> 中找到 <code>版本号</code>，连续点击，进入开发者模式，打开 <code>OEM解锁</code> 和 <code>USB调试</code>。OEM 必须一直开启。</p><p>使用ADB命令 <code>adb reboot bootloader</code> 重启手机，进入 <code>Bootloader</code> 模式。</p><div class="tip custom-block"><p class="custom-block-title">进入 Bootloader 模式的其他方法</p><p>你可以使用 <code>adb</code> 工具指示手机进入 <code>Bootloader</code> 模式。 对于某些手机，你还也可以使用按键组合进入 <code>Bootloader</code> 模式，比如按 <code>电源键</code> 重启，马上按住 <code>音量键-</code>。</p></div><p>输入 <code>fastboot flashing unlock</code> 解锁。详见 <a href="https://source.android.com/docs/core/architecture/bootloader/locking_unlocking" target="_blank" rel="noreferrer">安卓开发者文档-锁定/解锁引导加载程序</a>。</p><p>在手机上使用音量键选择 <code>UNLOCK THE BOOTLOADER</code>，按 <code>电源键</code> 确认。</p><h2 id="准备文件" tabindex="-1">准备文件 <a class="header-anchor" href="#准备文件" aria-label="Permalink to &quot;准备文件&quot;">​</a></h2><p>在手机的 <code>关于手机</code> 中，寻找系统版本号，记录下来。然后去下载对应的全量包或 <code>boot</code> 分区文件。</p><div class="info custom-block"><p class="custom-block-title">关于全量包</p><p>官方 ROM 的压缩包，例如 <a href="https://developers.google.com/android/images" target="_blank" rel="noreferrer">Google</a>、<a href="https://www.miui.com/shuaji-393.html" target="_blank" rel="noreferrer">小米</a>、<a href="https://mirrors.lolinet.com/firmware/moto/" target="_blank" rel="noreferrer">Moto</a>，它们由厂商发布，可从固定的发布页面、机型论坛等下载<strong>符合</strong>你的<strong>机型和型号</strong>的 Rom. 一些厂商同时提供了 OTA包 和 全量包 ，我们优先下载全量包，解压后即可获得 <code>boot.img</code>，也就是我们所需要的 <code>boot</code> 分区的镜像文件。 如果你使用的是第三方开发者制作的 ROM，也同样需要下载系统全量包解压获取，而部分开发者也会单独释出 <code>boot.img</code> 为玩家提供便利。 如果你的机型没有释放对应的 ROM 包，但是机器为联发科（天矶&lt;920），你可以利用芯片漏洞提取 <code>boot.img</code>。</p></div><p>下载全量包后，如果打开发现 <code>pyload.bin</code>，那么你需要使用 <code>payload dumper</code> 工具解包，请下载 <a href="https://github.com/ssut/payload-dumper-go/releases" target="_blank" rel="noreferrer">payload-dumper-go</a> 按照操作解包。</p><div class="tip custom-block"><p class="custom-block-title">工具如何使用</p><p>请打开浏览器的翻译功能，翻译 <a href="https://github.com/ssut/payload-dumper-go" target="_blank" rel="noreferrer">这个页面</a>。</p></div><p>解包的过程需要大约 <code>镜像大小*3</code> 硬盘空间。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Android 12 及更高版本的设备的架构中，包含通用 ramdisk 的为新 init_boot 映像，而不是传统的 boot 映像。 所以如果你的设备是 Android 12 及更高版本，你需要使用 <code>init_boot.img</code> 镜像文件。参考 <a href="https://source.android.com/docs/core/architecture/partitions/generic-boot?hl=zh-cn" target="_blank" rel="noreferrer">安卓开发文档-通用Boot镜像</a>。</p></div><h3 id="准备修补" tabindex="-1">准备修补 <a class="header-anchor" href="#准备修补" aria-label="Permalink to &quot;准备修补&quot;">​</a></h3><p>将镜像通过文叔叔或数据线传递到手机，打开 <code>Magisk Manager</code> ，点击 <code>Magisk</code> 后边的<code>安装</code>，选择安装方式为 <code>选择并修改一个文件</code> ，从手机端复制 <code>boot.img</code> 文件到手机并选中该文件，点击<code>开始</code> ，仔细阅读修改结果并从结果中复制patch后的文件（一般在 <code>Download</code> 文件夹下，文件名类似<code>magisk_patched-24100_gk0te.img</code>）到电脑。</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>有些安卓10及以上机型刷入修改的 <code>boot</code> 后可能会由于 <code>vbmeta.img</code> 的验证导致设备无法启动 ，可尝试保持 <code>boot</code> 镜像 中的 <code>vbmeta</code>,此选项在最新版面具中已支持。</p></div><p>现在你有了修补后的 boot 分区镜像文件和原始的 boot 分区镜像文件，把它们都复制到电脑上备用。</p><h3 id="准备刷写" tabindex="-1">准备刷写 <a class="header-anchor" href="#准备刷写" aria-label="Permalink to &quot;准备刷写&quot;">​</a></h3><div class="info custom-block"><p class="custom-block-title">A/B分区</p><p>从安卓 7.0 开始，厂商们引入了新的OTA升级方式 <code>A/B System Updates</code>，这种升级方式将 <code>boot</code> 等分区变为两套，叫做 <code>slot A</code> (boot_a,system_a...) 和 <code>slot B</code>(boot_b, system_b...)，平时使用的叫主分区，不用的叫备用分区。 系统升级时主备切换可以做到无缝升级。</p><p>为了解决双倍占用的问题，就有了 VAB 虚拟AB分区 (普遍见于安卓11以上的机器)。 VAB 的一个分区出现问题，另一个也会受到影响。</p><p>你可以在 运行 <code>adb shell getprop ro.boot.slot_suffix</code> 获取当前分区。</p></div><ul><li>临时启动</li></ul><p>如果你的机器支持 <code>fastboot boot</code>，那么你可以使用 <code>fastboot boot &lt;修改后的 boot.img 路径&gt;</code> 来临时启动 <code>Magisk</code>。 但是下次启动就会失去 <code>Root</code> 权限。</p><ul><li>刷写</li></ul><p>使用 <code>adb</code> 命令 <code>adb reboot bootloader</code> 重启手机，进入 <code>Bootloader</code> 模式。</p><p>使用 <code>fastboot</code> 命令 <code>fastboot devices</code> 检查设备是否连接，如果没有则为驱动问题。</p><p>使用 <code>fastboot</code> 命令 <code>fastboot flash boot &lt;修改后的 boot.img 路径&gt;</code> 刷写镜像。</p><p>输出类似以下结果，说明刷写成功。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">14514</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ownload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fastboot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> boot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">agisk_patched-20000_AAAAA.img</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sending</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;boot&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (29079 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">KB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                          OKAY [  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.936</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Writing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;boot&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                     OKAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.878</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Finished.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.085</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意事项</p><p>如果你的机型是 <code>A/B</code> 分区，那么你需要刷写 <code>boot_a</code> 或 <code>boot_b</code> 分区，否则可能不生效。 如果你的机器有 <code>init_boot.img</code> 分区，那么你需要用命令 <code>fastboot flash init_boot</code> 刷写 <code>init_boot</code> 分区。</p></div><p>使用 <code>fastboot</code> 命令 <code>fastboot reboot</code> 重启手机。</p><p>如果重启失败，刷写回原始的 boot 分区镜像文件，就可以修复。</p><p>如果重启成功，打开 <code>Magisk Manager</code> ，如果显示 <code>安装</code>，那么说明刷写成功。</p><p>但是刷机并没有完全结束，你还需要进行一些配置。</p>`,103),l=[i];function d(r,p,n,h,c,k){return a(),e("div",null,l)}const F=s(o,[["render",d]]);export{b as __pageData,F as default};
